<!--pages/ai-chat/ai-chat.wxml-->
<view class="chat-container">
  <!-- 聊天头部 -->
  <view class="chat-header">
    <view class="header-info">
      <text class="header-title">🤖 王吉成律师AI助手</text>
      <text class="header-subtitle">基于GLM-4.6 · 仅供参考</text>
    </view>
    <view class="header-actions">
      <text class="clear-btn" bindtap="clearChat">清空</text>
    </view>
  </view>

  <!-- 消息列表 -->
  <scroll-view
    id="chat-container"
    scroll-y
    class="message-list"
    scroll-into-view="msg-{{messages.length-1}}"
    scroll-top="{{scrollTop}}"
    scroll-with-animation>

    <block wx:for="{{messages}}" wx:key="time">
      <view id="msg-{{index}}" class="message {{item.role === 'user' ? 'user-message' : 'assistant-message'}}">
        <view class="message-content">
          <text class="message-text">{{item.content}}</text>
        </view>
      </view>
    </block>

    <!-- 加载中提示 -->
    <view wx:if="{{isLoading}}" class="message assistant-message">
      <view class="message-content loading">
        <text class="message-text">正在思考中</text>
        <view class="loading-dots">
          <text class="dot">.</text>
          <text class="dot">.</text>
          <text class="dot">.</text>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- 输入区域 -->
  <view class="input-area">
    <textarea
      class="input-box"
      value="{{inputValue}}"
      bindinput="onInput"
      placeholder="请输入您的法律问题..."
      maxlength="500"
      auto-height
      show-confirm-bar="{{false}}"
      disabled="{{isLoading}}" />
    <button
      class="send-btn"
      bindtap="sendMessage"
      disabled="{{isLoading || !inputValue}}">
      {{isLoading ? '发送中' : '发送'}}
    </button>
  </view>

  <!-- 免责声明 -->
  <view class="disclaimer">
    仅供参考，重大问题请咨询专业律师
  </view>
</view>
