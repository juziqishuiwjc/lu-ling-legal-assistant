<!--pages/admin/admin.wxml-->
<view class="container">
  <!-- ç®¡ç†å‘˜å¤´éƒ¨ -->
  <view class="header">
    <text class="title">ğŸ‘¨â€âš–ï¸ ç®¡ç†åå°</text>
    <text class="subtitle">ç‹å‰æˆå¾‹å¸ˆ - ç”¨æˆ·æ¿€æ´»ç®¡ç†</text>
  </view>

  <!-- æ¿€æ´»ç”¨æˆ· -->
  <view class="card">
    <text class="card-title">âœ¨ æ¿€æ´»ä»˜è´¹ç”¨æˆ·</text>
    <view class="input-group">
      <text class="input-label">ç”¨æˆ·æ‰‹æœºå·å8ä½</text>
      <input
        class="input-field"
        type="number"
        maxlength="8"
        placeholder="è¯·è¾“å…¥8ä½æ•°å­—"
        value="{{phoneInput}}"
        bindinput="onPhoneInput"
      />
    </view>
    <view class="input-group">
      <text class="input-label">å¥—é¤ç±»å‹</text>
      <view class="plan-selector">
        <view class="plan-option {{selectedPlan === 'trial' ? 'active' : ''}}" bindtap="selectPlan" data-plan="trial">
          <text class="plan-name">è¯•ç”¨</text>
          <text class="plan-price">æŒ‰å¤©è®¡ç®—</text>
        </view>
        <view class="plan-option {{selectedPlan === 'monthly' ? 'active' : ''}}" bindtap="selectPlan" data-plan="monthly">
          <text class="plan-name">æœˆä»˜</text>
          <text class="plan-price">Â¥99/æœˆ</text>
        </view>
        <view class="plan-option {{selectedPlan === 'yearly' ? 'active' : ''}}" bindtap="selectPlan" data-plan="yearly">
          <text class="plan-name">å¹´ä»˜</text>
          <text class="plan-price">Â¥996/å¹´</text>
        </view>
      </view>
    </view>
    <!-- è¯•ç”¨å¤©æ•°è¾“å…¥ï¼ˆä»…åœ¨é€‰æ‹©è¯•ç”¨å¥—é¤æ—¶æ˜¾ç¤ºï¼‰ -->
    <view class="input-group" wx:if="{{selectedPlan === 'trial'}}">
      <text class="input-label">è¯•ç”¨å¤©æ•°</text>
      <input
        class="input-field"
        type="number"
        placeholder="è¯·è¾“å…¥è¯•ç”¨å¤©æ•°ï¼ˆå¦‚ï¼š7ï¼‰"
        value="{{trialDays}}"
        bindinput="onTrialDaysInput"
      />
    </view>
    <button class="activate-button" bindtap="activateUser" disabled="{{!phoneInput}}">
      ç¡®è®¤æ¿€æ´»
    </button>
  </view>

  <!-- å·²æ¿€æ´»ç”¨æˆ·åˆ—è¡¨ -->
  <view class="card">
    <text class="card-title">ğŸ‘¥ å·²æ¿€æ´»ç”¨æˆ·</text>
    <view class="search-box">
      <input
        class="search-input"
        placeholder="æœç´¢æ‰‹æœºå·"
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
    </view>
    <scroll-view scroll-y class="user-list" wx:if="{{filteredUsers.length > 0}}">
      <view class="user-item" wx:for="{{filteredUsers}}" wx:key="phone" bindtap="showUserInfo" data-user="{{item}}">
        <view class="user-info-row">
          <text class="user-phone">æ‰‹æœºå·å8ä½ï¼š****{{item.phone}}</text>
          <view class="user-plan {{item.planType === 'yearly' ? 'yearly' : item.planType === 'trial' ? 'trial' : 'monthly'}}">
            <text class="plan-text">{{item.planType === 'yearly' ? 'å¹´ä»˜' : item.planType === 'trial' ? 'è¯•ç”¨' : 'æœˆä»˜'}}</text>
          </view>
        </view>
        <view class="user-meta">
          <text class="meta-text">æ¿€æ´»æ—¶é—´ï¼š{{item.activateTime}}</text>
        </view>
        <view class="user-meta">
          <text class="meta-text">åˆ°æœŸæ—¶é—´ï¼š{{item.expireDate}}</text>
        </view>
        <view class="user-meta">
          <text class="meta-text {{item.isExpired ? 'expired' : ''}}">å‰©ä½™æ—¶é—´ï¼š{{item.remainingDays}}</text>
        </view>
        <view class="tap-hint">
          <text class="hint-text">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</text>
        </view>
      </view>
    </scroll-view>
    <view class="empty-state" wx:else>
      <text class="empty-text">æš‚æ— å·²æ¿€æ´»ç”¨æˆ·</text>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="card stats-card">
    <text class="card-title">ğŸ“Š æ•°æ®ç»Ÿè®¡</text>
    <view class="stat-row">
      <view class="stat-box">
        <text class="stat-number">{{totalUsers}}</text>
        <text class="stat-label">æ€»ç”¨æˆ·æ•°</text>
      </view>
      <view class="stat-box">
        <text class="stat-number">{{paidUsers}}</text>
        <text class="stat-label">ä»˜è´¹ç”¨æˆ·</text>
      </view>
      <view class="stat-box">
        <text class="stat-number">{{yearlyUsers}}</text>
        <text class="stat-label">å¹´ä»˜ç”¨æˆ·</text>
      </view>
    </view>
  </view>

  <!-- å¯¼èˆªé“¾æ¥ -->
  <view class="nav-links">
    <button class="nav-button" bindtap="goToIndex">è¿”å›é¦–é¡µ</button>
  </view>
</view>
