# 微信小程序调试和上线完整指南

## 一、前期准备

### 1. 注册账号
- 访问 [微信公众平台](https://mp.weixin.qq.com/)
- 点击"立即注册"
- 选择"小程序"账号类型
- 填写邮箱、密码等基本信息
- 完成邮箱验证

### 2. 完善账号信息
- 登录小程序后台
- 填写小程序名称（例如："法律助手"）
- 上传小程序头像（建议尺寸：144x144px，不超过2MB）
- 填写小程序介绍
- 选择服务类目（建议：工具 > 法律）

### 3. 获取 AppID
- 登录小程序后台
- 进入"开发" > "开发设置"
- 复制"开发者ID"（AppID）
- **重要**：将 AppID 填入 `project.config.json` 的 `appid` 字段

## 二、开发工具配置

### 1. 下载微信开发者工具
- 访问 [微信开发者工具下载页面](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- 根据操作系统选择对应版本下载安装

### 2. 导入项目
1. 打开微信开发者工具
2. 选择"小程序"项目类型
3. 点击"导入"
4. 选择项目目录：`C:\Users\橘子汽水\ClaudeCode\xiaochengxu`
5. 填入 AppID（使用您的真实 AppID，不要用 touristappid）
6. 点击"导入"

### 3. 更新 AppID 配置
在 `project.config.json` 中将：
```json
"appid": "touristappid"
```
改为：
```json
"appid": "您的真实AppID"
```

## 三、调试流程

### 1. 本地调试
在微信开发者工具中：

#### 模拟器调试
- 左侧为手机模拟器
- 可以切换不同设备型号
- 实时预览界面效果
- 查看控制台输出（Console标签）

#### 真机调试
1. 点击工具栏"预览"按钮
2. 生成预览二维码
3. 使用微信扫码在真机上预览
4. 可以查看真机运行效果

#### 调试技巧
- **Console**：查看日志输出和错误信息
- **Sources**：断点调试 JavaScript 代码
- **Network**：查看网络请求（如果需要调用后端API）
- **Storage**：查看本地缓存数据
- **AppData**：实时查看和修改页面数据

### 2. 代码调试
在代码中添加 console.log：
```javascript
// pages/index/index.js
sendMessage() {
  console.log('发送消息:', this.data.inputText);
  console.log('当前消息列表:', this.data.messages);
  // ... 其他代码
}
```

### 3. 常见问题排查

#### 头像不显示
- 检查图片URL是否可访问
- 检查是否配置了合法域名
- 在开发阶段可以临时关闭域名校验

#### 域名校验
1. 开发阶段：在开发者工具 > 详情 > 本地设置 > 勾选"不校验合法域名"
2. 生产环境：必须配置合法域名
   - 登录小程序后台
   - 进入"开发" > "开发设置" > "服务器域名"
   - 添加图片域名：`i.ibb.co`

## 四、上线流程

### 步骤 1：代码上传
1. 在微信开发者工具中点击"上传"按钮
2. 填写版本号（例如：1.0.0）
3. 填写项目备注（例如：首次发布）
4. 点击"上传"

### 步骤 2：提交审核
1. 登录 [小程序后台](https://mp.weixin.qq.com/)
2. 进入"版本管理"
3. 在"开发版本"中找到刚才上传的版本
4. 点击"提交审核"
5. 填写审核信息：
   - 功能页面路径：`pages/index/index`
   - 功能描述：提供法律咨询服务，用户可以提问法律相关问题
   - 选择服务类目
   - 上传截图（至少2张）

### 步骤 3：审核
- 审核时间：通常 1-7 个工作日
- 审核结果会通过微信通知
- 如果审核失败，根据原因修改后重新提交

### 步骤 4：发布
- 审核通过后，在"审核版本"中点击"发布"
- 发布后，用户即可在微信中搜索到您的小程序

## 五、注意事项

### 1. 内容规范
- 确保内容符合法律法规
- 避免敏感词汇
- 法律咨询类小程序建议添加免责声明

### 2. 功能要求
- 建议添加"关于"页面说明服务范围
- 添加隐私政策和用户协议
- 如果使用 AI 接口，需要在页面中说明

### 3. 性能优化
- 压缩图片资源
- 优化代码体积
- 小程序包大小不能超过 2MB

### 4. 图片资源
- 当前使用的图片来自 `i.ibb.co` 图床
- 建议将图片下载后上传到自己的服务器或CDN
- 确保图片URL稳定可访问

### 5. 合法域名配置
登录小程序后台，添加以下域名（如果使用外链图片）：
- 图片域名：`https://i.ibb.co`
- request 合法域名：如果有后端API

## 六、建议优化项

### 1. 添加必要页面
```
pages/
├── index/          # 首页（已有）
├── about/          # 关于页面
└── feedback/       # 反馈页面
```

### 2. 完善用户体验
- 添加加载动画
- 优化错误提示
- 添加历史记录功能

### 3. 添加免责声明
在欢迎消息或关于页面添加：
```
注：本助手提供的法律建议仅供参考，
不构成正式法律意见。重要法律问题请咨询
专业律师。
```

## 七、快速检查清单

上线前请确认：
- [ ] 已获取真实 AppID
- [ ] 已更新 project.config.json 中的 appid
- [ ] 在开发者工具中测试通过
- [ ] 真机预览效果正常
- [ ] 头像图片可以正常显示
- [ ] 已配置合法域名
- [ ] 代码已上传到微信后台
- [ ] 已准备好审核说明和截图
- [ ] 了解并遵守微信小程序运营规范

## 八、调试命令

在开发者工具中：
- `Ctrl/Cmd + S`：保存文件
- `Ctrl/Cmd + B`：编译项目
- `Ctrl/Cmd + Shift + R`：清除缓存重新编译

## 九、常见问题

### Q1: 头像显示不出来？
**A**: 检查以下几点：
1. 图片URL是否可访问
2. 是否关闭了域名校验（开发阶段）
3. 图片格式是否支持（支持 JPG、PNG、SVG）

### Q2: 如何查看错误信息？
**A**:
1. 查看开发者工具的 Console 面板
2. 查看模拟器的错误提示
3. 使用 `console.log()` 调试

### Q3: 审核被拒绝怎么办？
**A**: 常见原因：
1. 内容不完整 → 补充功能说明
2. 缺少必要页面 → 添加关于页面
3. 测试账号不可用 → 提供可用测试信息
4. 内容违规 → 修改违规内容

### Q4: 上线后发现 Bug 怎么办？
**A**:
1. 修改代码
2. 上传新版本（版本号递增，如 1.0.1）
3. 提交审核
4. 审核通过后发布
5. 可以选择"灰度发布"逐步推广

## 十、技术支持

- 微信小程序开发文档：https://developers.weixin.qq.com/miniprogram/dev/framework/
- 微信开放社区：https://developers.weixin.qq.com/community/
- 问题反馈：在小程序后台提交工单

---

**下一步行动**：
1. 注册微信小程序账号
2. 获取 AppID
3. 下载安装微信开发者工具
4. 配置项目 AppID
5. 在开发者工具中测试
6. 准备上线材料
7. 提交审核

祝您上线顺利！
